<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Person Image Viewer</title>
  <script src="person-images.js"></script>
</head>
<body>
  <select id="personSelect">
    <option value="">Select a person</option>
    <option value="Q937">Albert Einstein (1879 - 1955)</option>
    <option value="Q935">Isaac Newton (1643 - 1727)</option>
    <!-- Add more people with known Wikidata IDs here -->
  </select>

  <input type="range" id="yearSlider" min="0" max="100" value="50">
  <span id="selectedYear">Year</span>

  <person-images></person-images>

  <script>
    document.getElementById('personSelect').addEventListener('change', function() {
      const selectedOption = this.options[this.selectedIndex];
      const wikidataId = selectedOption.value;
      const name = selectedOption.text;
      const birthYear = name.match(/\((\d+)/)[1];
      const deathYear = name.match(/(\d+)\)/)[1];

      // Dispatch the 'nodeSelected' event
      const nodeSelectedEvent = new CustomEvent('nodeSelected', {
        detail: { node: { wikidataId, name, birth: { date: `+${birthYear}` }, death: { date: `+${deathYear}` } } }
      });
      window.dispatchEvent(nodeSelectedEvent);

      // Set up the year slider range and initial value
      const yearSlider = document.getElementById('yearSlider');
      yearSlider.min = birthYear;
      yearSlider.max = deathYear;
      yearSlider.value = (parseInt(birthYear) + parseInt(deathYear)) / 2;
      document.getElementById('selectedYear').textContent = yearSlider.value;

      // Update the image when the slider value changes
      yearSlider.addEventListener('input', function() {
        document.getElementById('selectedYear').textContent = this.value;
        const timetravelEvent = new CustomEvent('timetravel', {
          detail: { date: `+${this.value}` }
        });
        window.dispatchEvent(timetravelEvent);
      });
    });

    window.addEventListener('imageChange', (event) => {
      const year = new Date(event.detail.date).getFullYear();
      const yearSlider = document.getElementById('yearSlider');
      yearSlider.value = year;
      document.getElementById('selectedYear').textContent = year;
    });
  </script>
</body>
</html>
